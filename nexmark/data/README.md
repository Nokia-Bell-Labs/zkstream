Adapted from Patrick's data.